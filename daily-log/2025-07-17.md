# 2025-07-17 学習ログ（2週目3日目）

## 本日の目標
- バグ修正とブランチ運用
- バグ修正ブランチ・PR・レビュー・マージ
- bugfix/fix-task-idの実装

---

## 実施内容

### 1. バグの特定と再現
```bash
# アプリを実行してバグをテスト
python3 src/main.py
```

#### テスト手順
1. タスクを追加（ID: 1）
2. タスクを削除（ID: 1）
3. 新しいタスクを追加（ID: 1が重複）
4. さらにタスクを追加（ID: 2）

#### 発見されたバグ
- **問題**: タスクを削除した後、新しいタスクのIDが重複する
- **原因**: `len(self.tasks) + 1`の方式では削除済みIDを考慮していない
- **影響**: 削除済みIDが再利用され、データの整合性が損なわれる

### 2. バグ修正用ブランチの作成
```bash
# バグ修正用ブランチを作成
git checkout -b bugfix/fix-task-id

# ブランチ作成を確認
git branch
```

### 3. バグ修正の実装
`src/todo.py`の`add_task`メソッドを修正：

#### 修正前（問題のコード）
```python
task = {
    'id': len(self.tasks) + 1,  # 削除済みIDを考慮しない
    'title': title,
    # ...
}
```

#### 修正後（解決コード）
```python
# 既存のタスクから最大IDを取得
max_id = 0
for task in self.tasks:
    if task['id'] > max_id:
        max_id = task['id']

# 新しいIDは最大ID + 1
new_id = max_id + 1

task = {
    'id': new_id,  # 削除済みIDを考慮
    'title': title,
    # ...
}
```

### 4. 修正の確認とテスト
```bash
# 修正内容を確認
git diff src/todo.py

# アプリを実行してテスト
python3 src/main.py
```

#### テスト結果
- タスク追加→削除→追加のテストを実行
- ID重複が解消されることを確認
- 正常に動作することを確認

### 5. 修正のコミット
```bash
# 変更をステージング
git add src/todo.py

# バグ修正をコミット
git commit -m "fix: タスクIDの重複問題を修正

- 削除後のタスクIDが重複する問題を解決
- 最大ID + 1の方式でID生成を改善
- 作成日時を更新"
```

### 6. ブランチをリモートにプッシュ
```bash
# バグ修正ブランチをリモートにプッシュ
git push -u origin bugfix/fix-task-id
```

### 7. GitHubでプルリクエスト作成
- **タイトル**: `fix: タスクIDの重複問題を修正`
- **説明**: 修正内容、問題の詳細、修正方法、テスト結果を記載
- **状態**: "No conflicts with base branch. Merging can be performed automatically."

### 8. レビューとマージ
- **変更内容の確認**: 「Files changed」タブで差分確認
- **レビューコメントの追加**: 修正内容の確認とマージ準備完了を記載
- **マージ実行**: 「Confirm merge」ボタンでマージ完了
- **ブランチ削除**: GitHub上でリモートブランチを削除

### 9. ローカル環境の更新
```bash
# mainブランチに切り替え
git checkout main

# 最新の変更を取得
git pull origin main

# 不要になったブランチを削除
git branch -d bugfix/fix-task-id
```

---

## 質問と回答

### Q1. バグ修正用ブランチの命名規則は？
- **A:** `bugfix/`プレフィックスを使用。例：`bugfix/fix-task-id`

### Q2. バグ修正のワークフローは？
- **A:** バグ特定→修正ブランチ作成→修正実装→テスト→PR→レビュー→マージ→ブランチ削除

### Q3. バグ修正のコミットメッセージは？
- **A:** `fix:`プレフィックスを使用。例：`fix: タスクIDの重複問題を修正`

### Q4. プルリクエストの説明には何を書く？
- **A:** 修正内容、問題の詳細、修正方法、テスト結果、関連Issue

### Q5. マージ後の後処理は？
- **A:** リモートブランチ削除→ローカルブランチ削除→mainブランチ更新

---

## 本日の気づき・学び

### 1. **バグ修正の重要性**
- 小さなバグでもデータ整合性に影響する
- 再現手順の明確化が重要
- 修正前後のテストが必須

### 2. **ブランチ命名規則の理解**
- `bugfix/`プレフィックスの意味
- 修正内容を明確にする命名の重要性
- チーム開発での分かりやすさ

### 3. **バグ修正のワークフロー**
- 専用ブランチでの修正
- プルリクエストでのレビュー
- マージ後の後処理

### 4. **コミットメッセージの重要性**
- `fix:`プレフィックスで修正であることを明示
- 修正内容と理由を明確に記載
- 履歴として残る情報の整理

### 5. **テストの重要性**
- 修正前のバグ再現
- 修正後の動作確認
- 回帰テストの実施

---

## 実践したGitコマンド

```bash
# ブランチ操作
git checkout -b bugfix/fix-task-id
git branch

# 変更管理
git add src/todo.py
git commit -m "fix: タスクIDの重複問題を修正"
git push -u origin bugfix/fix-task-id

# ブランチ削除
git checkout main
git pull origin main
git branch -d bugfix/fix-task-id
```

---

## バグ修正の技術的詳細

### 問題の根本原因
- **ID生成方式**: `len(self.tasks) + 1`
- **問題点**: 削除済みタスクのIDを考慮しない
- **影響**: 削除→追加でID重複が発生

### 解決方法
- **新しい方式**: 既存タスクの最大ID + 1
- **メリット**: 削除済みIDの重複を防止
- **実装**: ループで最大IDを計算

### 修正の検証
- **テストケース**: 追加→削除→追加の繰り返し
- **期待結果**: IDが連続的に増加
- **実際結果**: 重複なしで正常動作

---

## 次回の学習予定

**2週目4日目：新機能開発とブランチ戦略**
- 複数ブランチでの並行開発
- マージ競合解決
- `feature/priority + feature/due-date`の例
- 競合解決の実践

---

## その他・メモ

- バグ修正は迅速かつ確実に行うことが重要
- 修正内容は必ずテストで検証する
- プルリクエストでのレビューは品質向上に効果的
- ブランチの適切な削除でリポジトリを整理する

---

## 振り返り

今日は「バグ修正とブランチ運用」を通じて、実際の開発現場で起こりうる問題の解決方法を学んだ。特に、バグの特定→修正→テスト→PR→マージの一連の流れを体験することで、実践的なGitワークフローを理解できた。また、バグ修正の技術的な詳細（ID生成方式の改善）も学べ、コードの品質向上についても考えさせられた。明日は複数ブランチでの並行開発を通じて、より高度なGit運用を学んでいきたい。 